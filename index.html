<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<meta name="theme-color" content="#000000">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta name="apple-mobile-web-app-title" content="VR Explorer">
<title>VR Explorer</title>
<link rel="manifest" href="/ExplorerTest11/manifest.json">

<style>
body { margin:0; font-family: Arial, sans-serif; background-color: black; color: white; display:flex; flex-direction: column; align-items:center; justify-content:flex-start; min-height:100vh; }
h1,h2 { text-align:center; margin:10px 0; }
select, button { width: 250px; padding:10px; margin:5px 0; font-size:1rem; }
button { background-color: grey; color:white; border:none; border-radius:8px; cursor:pointer; }
button.active { background-color: green; }
#playerWrap { position: fixed; top:0; left:0; width:100vw; height:100vh; display:none; justify-content:center; align-items:center; background-color:black; z-index:1000; }
#playerWrap iframe { width:100%; height:100%; }
footer { font-size:0.8rem; font-style:italic; margin-top:15px; margin-bottom:25px; text-align:center; }
.dropdown-wrapper { display:flex; flex-direction:column; align-items:center; margin-bottom:10px; }
.or-text { margin:5px 0; }
#safeModeOptions { display:flex; flex-direction:column; align-items:flex-start; margin-top:10px; }
#safeModeOptions label { margin:3px 0; cursor:pointer; }
</style>
</head>
<body>

<h1>VR Explorer</h1>
<h2>Step 1: Select Simulation</h2>

<div class="dropdown-wrapper">
    <label for="audienceSelect">Audience Sizes:</label>
    <select id="audienceSelect"></select>

    <div class="or-text">or</div>

    <label for="scenarioSelect">Special Scenarios:</label>
    <select id="scenarioSelect"></select>
</div>

<h2>Step 2: Enter Simulation</h2>
<button id="openBtn">Go</button>

<div id="safeModeOptions">
    <p>Safe Mode Options:</p>
    <label><input type="radio" name="safeMode" value="AndroidSafeMode"> Android Safe Mode</label>
    <label><input type="radio" name="safeMode" value="LaptopSafeMode"> Laptop Safe Mode</label>
    <label><input type="radio" name="safeMode" value="iPhoneSafeMode"> iPhone Safe Mode</label>
</div>

<div id="playerWrap"></div>

<footer>VR Explorer 1.1 brought to you by Cambridge VR</footer>

<script>
// ---------------- VIDEO DATA ----------------
// Audience Sizes
const audienceVideos = {
    "Audience of 0": { DefaultOption:"https://player.virtualrealitypublicspeaking.com/?video=N0-CF", AndroidSafeMode:"https://www.youtube.com/watch?v=8D5ZJjV-9No", LaptopSafeMode:"https://www.youtube.com/watch?v=8D5ZJjV-9No", iPhoneSafeMode:"https://testing.virtual-reality-publics-peaking-player.pages.dev/?video=N0-CF" },
    "Audience of 1": { DefaultOption:"https://player.virtualrealitypublicspeaking.com/?video=N1-CF", AndroidSafeMode:"https://www.youtube.com/watch?v=L61TY-lVWYc", LaptopSafeMode:"https://www.youtube.com/watch?v=L61TY-lVWYc", iPhoneSafeMode:"https://testing.virtual-reality-publics-peaking-player.pages.dev/?video=N1-CF" },
    "Audience of 2": { DefaultOption:"https://player.virtualrealitypublicspeaking.com/?video=N2-CF", AndroidSafeMode:"https://www.youtube.com/watch?v=jisLJabMOaw", LaptopSafeMode:"https://www.youtube.com/watch?v=jisLJabMOaw", iPhoneSafeMode:"https://testing.virtual-reality-publics-peaking-player.pages.dev/?video=N2-CF" },
    "Audience of 4": { DefaultOption:"https://player.virtualrealitypublicspeaking.com/?video=N4-CF", AndroidSafeMode:"https://www.youtube.com/watch?v=583YioSTgGE", LaptopSafeMode:"https://www.youtube.com/watch?v=583YioSTgGE", iPhoneSafeMode:"https://testing.virtual-reality-publics-peaking-player.pages.dev/?video=N4-CF" },
    "Audience of 9": { DefaultOption:"https://player.virtualrealitypublicspeaking.com/?video=N9-CF", AndroidSafeMode:"https://www.youtube.com/watch?v=7AS7NEA9PFo", LaptopSafeMode:"https://www.youtube.com/watch?v=7AS7NEA9PFo", iPhoneSafeMode:"https://testing.virtual-reality-publics-peaking-player.pages.dev/?video=N9-CF" },
    "Audience of 16": { DefaultOption:"https://player.virtualrealitypublicspeaking.com/?video=N16-CF", AndroidSafeMode:"https://www.youtube.com/watch?v=_y-lSw1SNaU", LaptopSafeMode:"https://www.youtube.com/watch?v=_y-lSw1SNaU", iPhoneSafeMode:"https://testing.virtual-reality-publics-peaking-player.pages.dev/?video=N16-CF" },
    "Audience of 25": { DefaultOption:"https://player.virtualrealitypublicspeaking.com/?video=N25-CF", AndroidSafeMode:"https://www.youtube.com/watch?v=CBBwXbX5ogE", LaptopSafeMode:"https://www.youtube.com/watch?v=CBBwXbX5ogE", iPhoneSafeMode:"https://testing.virtual-reality-publics-peaking-player.pages.dev/?video=N25-CF" },
    "Audience of 50": { DefaultOption:"https://player.virtualrealitypublicspeaking.com/?video=N50-CF", AndroidSafeMode:"https://www.youtube.com/watch?v=RUnKCfWFSfI", LaptopSafeMode:"https://www.youtube.com/watch?v=RUnKCfWFSfI", iPhoneSafeMode:"https://testing.virtual-reality-publics-peaking-player.pages.dev/?video=N50-CF" },
    "Audience of 100": { DefaultOption:"https://player.virtualrealitypublicspeaking.com/?video=N100-CF", AndroidSafeMode:"https://www.youtube.com/watch?v=ww986pYF46E", LaptopSafeMode:"https://www.youtube.com/watch?v=ww986pYF46E", iPhoneSafeMode:"https://testing.virtual-reality-publics-peaking-player.pages.dev/?video=N100-CF" },
    "Audience of 500": { DefaultOption:"https://player.virtualrealitypublicspeaking.com/?video=N500-CF", AndroidSafeMode:"https://www.youtube.com/watch?v=S3Ve7FGfjWk", LaptopSafeMode:"https://www.youtube.com/watch?v=S3Ve7FGfjWk", iPhoneSafeMode:"https://testing.virtual-reality-publics-peaking-player.pages.dev/?video=N500-CF" },
    "Audience of 1000s": { DefaultOption:"https://player.virtualrealitypublicspeaking.com/?video=N10K-CF", AndroidSafeMode:"https://www.youtube.com/watch?v=jyUNFPBmJkA", LaptopSafeMode:"https://www.youtube.com/watch?v=jyUNFPBmJkA", iPhoneSafeMode:"https://testing.virtual-reality-publics-peaking-player.pages.dev/?video=N10K-CF" }
};

// Special Scenarios
const scenarioVideos = {
    "TV teleprompter": { DefaultOption:"https://player.virtualrealitypublicspeaking.com/?video=ACC01-CF", AndroidSafeMode:"https://www.youtube.com/watch?v=3ZNddx_YNc0", LaptopSafeMode:"https://www.youtube.com/watch?v=3ZNddx_YNc0", iPhoneSafeMode:"https://testing.virtual-reality-publics-peaking-player.pages.dev/?video=ACC01-CF" },
    "Job interview": { DefaultOption:"https://player.virtualrealitypublicspeaking.com/?video=JIC01-CF", AndroidSafeMode:"https://www.youtube.com/watch?v=-tsxJfabw0s", LaptopSafeMode:"https://www.youtube.com/watch?v=-tsxJfabw0s", iPhoneSafeMode:"https://testing.virtual-reality-publics-peaking-player.pages.dev/?video=JIC01-CF" },
    "Radio interview": { DefaultOption:"https://player.virtualrealitypublicspeaking.com/?video=RIC01-CF", AndroidSafeMode:"https://www.youtube.com/watch?v=sE3pahN4BwI", LaptopSafeMode:"https://www.youtube.com/watch?v=sE3pahN4BwI", iPhoneSafeMode:"https://testing.virtual-reality-publics-peaking-player.pages.dev/?video=RIC01-CF" }
};

// ---------------- DOM ELEMENTS ----------------
const audienceSelect = document.getElementById("audienceSelect");
const scenarioSelect = document.getElementById("scenarioSelect");
const openBtn = document.getElementById("openBtn");
const playerWrap = document.getElementById("playerWrap");
let selectedVideoKey = null;

// ---------------- POPULATE DROPDOWNS ----------------
function populateDropdown(selectElement, videosObj){
    selectElement.innerHTML = '<option value="">--select option--</option>';
    Object.keys(videosObj).forEach(key => {
        const option = document.createElement('option');
        option.value = key;
        option.textContent = key;
        selectElement.appendChild(option);
    });
}

populateDropdown(audienceSelect, audienceVideos);
populateDropdown(scenarioSelect, scenarioVideos);

// ---------------- VIDEO SELECTION ----------------
function updateSelectedVideo() {
    selectedVideoKey = audienceSelect.value || scenarioSelect.value || null;
    openBtn.classList.toggle("active", !!selectedVideoKey);
}

audienceSelect.addEventListener("change", () => { scenarioSelect.value = ""; updateSelectedVideo(); });
scenarioSelect.addEventListener("change", () => { audienceSelect.value = ""; updateSelectedVideo(); });

// ---------------- CLOSE PLAYER ----------------
function closePlayer() {
    playerWrap.style.display = "none";
    playerWrap.innerHTML = "";
}

// ---------------- OPEN BUTTON ----------------
openBtn.addEventListener("click", () => {
    if (!selectedVideoKey) return;

    const video = audienceVideos[selectedVideoKey] || scenarioVideos[selectedVideoKey];
    if (!video) return;

    const selectedSafeMode = document.querySelector('input[name="safeMode"]:checked')?.value || null;
    let linkToOpen = selectedSafeMode ? video[selectedSafeMode] : video.DefaultOption;
    if (!linkToOpen) return;

    const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;

    if (!selectedSafeMode) { // Default VR Mode
        if (isIOS) {
            window.location.href = linkToOpen;
        } else {
            playerWrap.innerHTML = `
                <iframe src="${linkToOpen}" allow="autoplay; fullscreen; accelerometer; gyroscope; xr-spatial-tracking"></iframe>
                <button onclick="closePlayer()" style="position:absolute;top:10px;right:10px;z-index:1001;padding:10px 15px;font-size:1rem;border:none;border-radius:8px;cursor:pointer;">Exit VR</button>
            `;
            playerWrap.style.display="flex";
        }
    } else {
        window.open(linkToOpen, "_blank"); // Safe Mode
    }
});
</script>

</body>
</html>
